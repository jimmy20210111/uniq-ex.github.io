(this["webpackJsonpuniq-ex"]=this["webpackJsonpuniq-ex"]||[]).push([[0],{277:function(e,t,n){},406:function(e,t){},407:function(e,t){},426:function(e,t){},428:function(e,t){},438:function(e,t){},440:function(e,t){},481:function(e,t){},483:function(e,t){},490:function(e,t){},491:function(e,t){},521:function(e,t){},540:function(e,t){},547:function(e,t,n){var a={"./aes":241,"./aes.js":241,"./big":242,"./big.js":242,"./ctx":146,"./ctx.js":146,"./ecdh":243,"./ecdh.js":243,"./ecp":244,"./ecp.js":244,"./ecp2":245,"./ecp2.js":245,"./ff":246,"./ff.js":246,"./fp":247,"./fp.js":247,"./fp12":248,"./fp12.js":248,"./fp2":249,"./fp2.js":249,"./fp4":250,"./fp4.js":250,"./gcm":251,"./gcm.js":251,"./hash256":252,"./hash256.js":252,"./hash384":253,"./hash384.js":253,"./hash512":254,"./hash512.js":254,"./mpin":255,"./mpin.js":255,"./newhope":256,"./newhope.js":256,"./nhs":257,"./nhs.js":257,"./pair":258,"./pair.js":258,"./rand":259,"./rand.js":259,"./rom_curve":260,"./rom_curve.js":260,"./rom_field":261,"./rom_field.js":261,"./rsa":262,"./rsa.js":262,"./sha3":263,"./sha3.js":263,"./uint64":264,"./uint64.js":264};function c(e){var t=i(e);return n(t)}function i(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}c.keys=function(){return Object.keys(a)},c.resolve=i,e.exports=c,c.id=547},561:function(e,t,n){},578:function(e,t,n){"use strict";n.r(t);var a=n(21),c=n(1),i=n(0),s=n(23),r=n.n(s),l=(n(277),n(271)),o=n(38),d=n.n(o),u=n(82),j=n(16),m=n(27),p=n(148),b=n(6),h=n(270),f=n(34),O=n.n(f),v=n(81);function x(e,t){var n=new RegExp("(^|&)".concat(t,"=([^&]*)(&|$)"),"i"),a=e.substr(1).match(n);return null!=a?a[2]:null}var N="MAIN",g="2327be612cf6126bc54f5e8d77dcf2faf1883e6e",k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};try{var n=JSON.parse(e);"wasm contract does not exist"===n.Result&&t("CONTRACT_ADDRESS_ERROR")}catch(a){}},w=(n(561),Math.pow(10,6)),y=p.utils.StringReader,_=p.utils.hexstr2str,S=function(){var e=Object(i.useState)(localStorage.getItem("account")),t=Object(j.a)(e,2),n=t[0],s=t[1],r=Object(i.useState)([]),o=Object(j.a)(r,2),p=o[0],f=o[1],S=Object(i.useState)({}),C=Object(j.a)(S,2),R=C[0],T=C[1],L=Object(i.useState)({}),A=Object(j.a)(L,2),I=A[0],E=A[1],D=Object(i.useState)([]),U=Object(j.a)(D,2),P=U[0],W=U[1],q=Object(i.useState)([]),F=Object(j.a)(q,2),M=F[0],H=F[1],V=Object(i.useState)("all"),B=Object(j.a)(V,2),J=B[0],G=B[1],Y=Object(i.useState)(""),$=Object(j.a)(Y,2),z=$[0],K=$[1],Q=Object(i.useState)(""),X=Object(j.a)(Q,2),Z=X[0],ee=X[1],te=Object(i.useState)(0),ne=Object(j.a)(te,2),ae=ne[0],ce=ne[1],ie=Object(i.useState)([]),se=Object(j.a)(ie,2),re=se[0],le=se[1],oe=Object(i.useState)(0),de=Object(j.a)(oe,2),ue=de[0],je=de[1],me=Object(i.useState)({show:!1,type:"success",text:"",extraText:"",extraLink:""}),pe=Object(j.a)(me,2),be=pe[0],he=pe[1],fe=Object(i.useState)(!1),Oe=Object(j.a)(fe,2),ve=Oe[0],xe=Oe[1],Ne=Object(i.useState)(!0),ge=Object(j.a)(Ne,2),ke=ge[0],we=ge[1],ye=Object(i.useState)(!1),_e=Object(j.a)(ye,2),Se=_e[0],Ce=_e[1],Re=Object(v.c)(),Te=parseInt(x(window.location.hash,"asset")||1),Le=parseInt(x(window.location.hash,"price")||2);function Ae(){if(!p.length)try{m.client.api.smartContract.invokeWasmRead({scriptHash:g,operation:"get_all_tokens",args:[]}).then((function(e){we(!1);for(var t=[],n=new y(e),a=n.readNextLen(),c=0;c<a;c++){var i={},s=n.readNextLen();i.name=_(n.read(s)),i.address=n.read(20),i.ty=n.readUint8(),i.decimals=n.readUint128(),i.id=n.readUint128(),t.push(i)}for(var r={},l=0;l<t.length;l++)r[t[l].name]=t[l];var o=Object.values(r).map((function(e){return{id:e.id,decimals:e.decimals,name:e.name,value:e.id,label:e.name}}));f(o);var d=o.filter((function(e){return Te===e.id}))[0];T(d||o[0]),d=o.filter((function(e){return Le===e.id}))[0],E(d||o[1])})).catch((function(e){console.log(e),k(e,(function(t){console.log(t),"CONTRACT_ADDRESS_ERROR"===t?Ce(!0):console.log("get all tokens",e)}))}))}catch(e){console.log(e)}}function Ie(){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(u.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.client.api.provider.getProvider();case 3:return e.next=5,m.client.api.network.getNetwork();case 5:if(!(t=e.sent)||t.type===N){e.next=9;break}return Re.error("Please connect to the ".concat(N,"-Net")),e.abrupt("return");case 9:return e.next=11,m.client.api.asset.getAccount();case 11:n=e.sent,s(n),localStorage.setItem("account",n),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),"NO_PROVIDER"===e.t0&&Re.error("Please install wallet extension first");case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function De(){return(De=Object(u.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=3;break}return Re.show("Please Connect Wallet First"),e.abrupt("return");case 3:if(!R.id){e.next=24;break}if(R.id!==I.id){e.next=7;break}return Re.error("Please select different token"),e.abrupt("return");case 7:if(!(z<=0)){e.next=10;break}return Re.error("Price should be greater than 0"),e.abrupt("return");case 10:if(!(Z<=0)){e.next=13;break}return Re.error("Amount should be greater than 0"),e.abrupt("return");case 13:return e.prev=13,t=[{type:"Address",value:n},{type:"Long",value:R.id},{type:"Long",value:I.id},{type:"Long",value:new O.a(z).times(w).integerValue(O.a.ROUND_DOWN).toString()},{type:"Long",value:new O.a(Z).times(new O.a(Math.pow(10,R.decimals))).integerValue(O.a.ROUND_DOWN).toString()}],e.next=17,m.client.api.smartContract.invokeWasm({scriptHash:g,operation:"make",args:t,gasPrice:2500,gasLimit:3e6,requireIdentity:!1});case 17:(a=e.sent).transaction&&he({show:!0,type:"success",text:"Transaction Successful",extraText:"View Transaction",extraLink:"https://explorer.ont.io/transaction/".concat(a.transaction)}),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(13),he({show:!0,type:"error",text:"Transaction Failed",extraText:"".concat(e.t0),extraLink:""});case 24:case"end":return e.stop()}}),e,null,[[13,21]])})))).apply(this,arguments)}function Ue(e){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(u.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n||!t){e.next=9;break}return e.prev=1,e.next=4,m.client.api.smartContract.invokeWasm({scriptHash:g,operation:"unmake",args:[{type:"Address",value:n},{type:"Long",value:t}],gasPrice:2500,gasLimit:3e6,requireIdentity:!1});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.log("onunmake",e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})))).apply(this,arguments)}function We(e){if(R.id){var t="my"===J?M:P;return"sell"===e?t.filter((function(e){return e.asset_token_id===R.id&&e.price_token_id===I.id})).map((function(e){return Object(c.jsxs)("div",{className:"my-make-item reverse",children:[Object(c.jsx)("div",{className:"make-item-detail make-sell",children:e.price/w}),Object(c.jsx)("div",{className:"make-item-detail",children:new O.a(e.amount).div(Math.pow(10,R.decimals)).toString()}),"my"===J&&Object(c.jsx)("div",{className:"unmake-btn",onClick:function(){return Ue(e.make_id)},children:"Cancel"})]},e.make_id)})):t.filter((function(e){return e.asset_token_id===I.id&&e.price_token_id===R.id})).map((function(e){return Object(c.jsxs)("div",{className:"my-make-item",children:[Object(c.jsx)("div",{className:"make-item-detail make-buy",children:w/e.price}),Object(c.jsx)("div",{className:"make-item-detail",children:new O.a(e.amount).times(e.price).div(w).div(Math.pow(10,I.decimals)).toString()}),"my"===J&&Object(c.jsx)("div",{className:"unmake-btn",onClick:function(){return Ue(e.make_id)},children:"Cancel"})]},e.make_id)}))}return null}function qe(e){if(p.length){var t="asset"===e?Fe:Me,n={};return n="asset"===e?p.filter((function(e){return Te===e.id}))[0]||p[0]:p.filter((function(e){return Le===e.id}))[0]||p[1],Object(c.jsx)(h.a,{className:"token-select",defaultValue:n,options:p,isSearchable:!1,components:{Option:function(e){return Object(c.jsx)(b.f.Option,Object(a.a)(Object(a.a)({},e),{},{children:Object(c.jsxs)("div",{className:"option-wrapper",children:[Object(c.jsx)("div",{className:"option-icon-".concat(e.label," option-icon")}),Object(c.jsx)("div",{className:"option-label",children:e.label})]})}))},SingleValue:function(e){var t=e.children,n=Object(l.a)(e,["children"]);return Object(c.jsx)(b.f.SingleValue,Object(a.a)(Object(a.a)({},n),{},{children:Object(c.jsxs)("div",{className:"option-wrapper",children:[Object(c.jsx)("div",{className:"option-icon-".concat(t," option-icon")}),Object(c.jsx)("div",{className:"option-label",children:t})]})}))}},onChange:function(e){return t(e)},theme:function(e){return Object(a.a)(Object(a.a)({},e),{},{borderRadius:0,colors:Object(a.a)(Object(a.a)({},e.colors),{},{primary:"#2c2c2c"})})}})}}function Fe(e){e.value!==R.id&&T(p.filter((function(t){return t.id===e.value}))[0])}function Me(e){e.value!==I.id&&E(p.filter((function(t){return t.id===e.value}))[0])}function He(e){xe(e)}return Object(i.useEffect)((function(){Ae();var e=!Se&&setInterval((function(){p.length?clearInterval(e):Ae()}),5e3);return function(){e&&clearInterval(e)}}),[p,Se]),Object(i.useEffect)((function(){function e(){if(R.id){if(R.id===I.id)return W([]),void je(0);try{m.client.api.smartContract.invokeWasmRead({scriptHash:g,operation:"get_makes_of_pair",args:[{type:"Long",value:R.id},{type:"Long",value:I.id}]}).then((function(e){for(var t=[],n=new y(e),a=n.readUint128(),c=R.id<I.id?R.id:I.id,i=R.id<I.id?I.id:R.id,s=0;s<=1;s++)for(var r=n.readNextLen(),l=0;l<r;l++){var o={};o.make_id=n.readUint128(),o.price=n.readUint128(),o.amount=new O.a(n.readUint128()).toString(),o.asset_token_id=0===s?c:i,o.price_token_id=0===s?i:c,t.push(o)}je(a?R.id<I.id?a/w:w/a:0),W(t)})).catch((function(e){k(e,(function(t){"CONTRACT_ADDRESS_ERROR"===t?Ce(!0):console.log("get makes of pair",e)}))}))}catch(e){console.log(e)}}}e();var t=!Se&&setInterval(e,2e3);return function(){t&&clearInterval(t)}}),[R,I,n,Se]),Object(i.useEffect)((function(){function e(){if(n)try{m.client.api.smartContract.invokeWasmRead({scriptHash:g,operation:"get_user_makes",args:[{type:"Address",value:n}]}).then((function(e){for(var t=[],n=new y(e),a=n.readNextLen(),c=0;c<a;c++){var i={};i.address=m.client.api.utils.hexToAddress(n.read(20)),i.asset_token_id=n.readUint128(),i.price_token_id=n.readUint128(),i.price=n.readUint128(),i.amount=n.readUint128(),i.make_id=n.readUint128(),t.push(i)}H(t)})).catch((function(e){k(e,(function(t){"CONTRACT_ADDRESS_ERROR"===t?Ce(!0):console.log("get user makes",e)}))}))}catch(e){console.log(e)}}e();var t=!Se&&setInterval(e,5e3);return function(){t&&clearInterval(t)}}),[R,I,n,Se]),Object(i.useEffect)((function(){function e(){return t.apply(this,arguments)}function t(){return(t=Object(u.a)(d.a.mark((function e(){var t,n,a,c,i,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p.length){e.next=17;break}return e.prev=1,e.next=4,m.client.api.smartContract.invokeWasmRead({scriptHash:g,operation:"stat",args:[]});case 4:for(t=e.sent,n=[],(a=new y(t)).readUint128(),c=a.readNextLen(),i=function(e){var t={};t.id=a.readUint128();var c=p.filter((function(e){return e.id===t.id}))[0];t.balance=new O.a(a.readUint128()).div(new O.a(Math.pow(10,c.decimals))).toString(),t.name=c.name,n.push(t)},s=0;s<c;s++)i();le(n),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),k(e.t0,(function(t){"CONTRACT_ADDRESS_ERROR"===t?Ce(!0):console.log("get stat",e.t0)}));case 17:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)}e();var n=setInterval((function(){Se?clearInterval(n):e()}),5e3);return function(){return clearInterval(n)}}),[p,Se]),Object(i.useEffect)((function(){ce((z||0)*(Z||0))}),[z,Z]),Object(i.useEffect)((function(){G("all")}),[n]),Object(c.jsxs)("div",{className:"app",children:[null===n&&Object(c.jsx)("div",{className:"connect-wallet-overlay",children:Object(c.jsxs)("div",{className:"connect-wrapper",children:[Object(c.jsx)("p",{className:"connect-title",children:"Connect Wallet"}),Object(c.jsx)("div",{className:"wallet-item",onClick:function(){return Ie()},children:"Cyano Wallet"})]})}),be.show?Object(c.jsx)("div",{className:"info-modal-overlay",children:Object(c.jsxs)("div",{className:"modal-wrapper",children:[Object(c.jsx)("div",{className:"close-btn",onClick:function(){he(Object(a.a)(Object(a.a)({},be),{},{show:!1}))}}),Object(c.jsx)("div",{className:"modal-icon-".concat(be.type," modal-icon")}),Object(c.jsx)("div",{className:"modal-text-".concat(be.type," modal-text"),children:be.text}),Object(c.jsx)("div",{className:"modal-extra-text",children:be.extraLink?Object(c.jsx)("a",{className:"transaction-link",target:"_blank",rel:"noreferrer",href:be.extraLink,children:be.extraText}):be.extraText})]})}):null,ve?Object(c.jsx)("div",{className:"info-modal-overlay",children:Object(c.jsxs)("div",{className:"modal-wrapper",children:[Object(c.jsx)("div",{className:"close-btn",onClick:function(){return He(!1)}}),Object(c.jsx)("p",{className:"intro-line",children:"uniq-ex is a pure github based DAO dex, all activities are logged on github."}),Object(c.jsxs)("p",{className:"intro-line",children:["You can open issues for discussion ",Object(c.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://github.com/uniq-ex/uniq-ex/issues",children:"here"})]}),Object(c.jsx)("p",{className:"intro-line",children:"uniq-ex's future business will not be limited to exchanges though, we may enter various DeFi markets like compound or hegic."}),Object(c.jsxs)("p",{className:"intro-line",children:["We're open to crowdfunding, you can buy our governance token ",Object(c.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://uniq-ex.github.io/#asset=1&price=2",children:"here"})]})]})}):null,ke?Object(c.jsx)("div",{className:"info-modal-overlay",children:Object(c.jsxs)("div",{className:"modal-wrapper",children:[Object(c.jsx)("div",{className:"modal-icon-loading modal-icon"}),Object(c.jsx)("div",{className:"modal-text",children:"Loading Tokens"})]})}):null,Object(c.jsx)("div",{className:"header",children:Object(c.jsxs)("div",{className:"content-wrapper",children:[Object(c.jsx)("div",{className:"logo-wrapper",children:Object(c.jsx)("div",{className:"site-intro",onClick:function(){return He(!0)}})}),Object(c.jsxs)("div",{className:"profile-wrapper",children:[n&&Object(c.jsx)("span",{className:"account-address",children:n}),n&&Object(c.jsx)("span",{className:"signout-btn",onClick:function(){return s(""),void localStorage.setItem("account","")},children:"Sign Out"}),""===n&&Object(c.jsx)("span",{className:"connect-btn",onClick:function(){return Ie()},children:"Connect Wallet"})]})]})}),Object(c.jsxs)("div",{className:"trade-container",children:[Object(c.jsxs)("div",{className:"make-wrapper",children:[Object(c.jsx)("div",{className:"container-header",children:"Transaction"}),Object(c.jsxs)("div",{className:"form-item",children:[Object(c.jsx)("div",{className:"item-title",children:"Amount"}),Object(c.jsxs)("div",{className:"input-wrapper",children:[qe("asset"),Object(c.jsx)("input",{className:"input inline-input",placeholder:"Amount",type:"number",onChange:function(e){return ee(e.target.value)}})]})]}),Object(c.jsxs)("div",{className:"form-item",children:[Object(c.jsxs)("div",{className:"item-title",children:["Price",Object(c.jsx)("span",{className:"hint",children:function(){if(R.id)return"1 ".concat(R.name," = ").concat(z||"?"," ").concat(I.name)}()})]}),Object(c.jsx)("div",{className:"input-wrapper",children:Object(c.jsx)("input",{className:"input",placeholder:"Price",type:"number",onChange:function(e){return K(e.target.value)}})})]}),Object(c.jsxs)("div",{className:"form-item",children:[Object(c.jsx)("div",{className:"item-title",children:"Will Get"}),Object(c.jsxs)("div",{className:"input-wrapper",children:[qe("price"),Object(c.jsx)("input",{className:"input inline-input",disabled:!0,type:"number",value:ae})]})]}),Object(c.jsx)("div",{className:"make-btn",onClick:function(){return function(){return De.apply(this,arguments)}()},children:"Sell"})]}),Object(c.jsxs)("div",{className:"trade-panel",children:[Object(c.jsxs)("div",{className:"panel-header",children:[Object(c.jsx)("div",{className:"panel-title",children:"Order Book"}),Object(c.jsxs)("div",{className:"tabs",children:[Object(c.jsx)("div",{className:"all"===J?"tab-wrapper selected":"tab-wrapper",onClick:function(){return G("all")},children:"All"}),Object(c.jsx)("div",{className:"my"===J?"tab-wrapper selected":"tab-wrapper",onClick:function(){n?G("my"):Re.show("Please Connect Wallet First")},children:"My"})]})]}),Object(c.jsxs)("div",{className:"list-title",children:[Object(c.jsx)("div",{className:"blank-placeholder"}),Object(c.jsxs)("div",{className:"title-items",children:[Object(c.jsxs)("div",{className:"item-text",children:["Price (",function(){if(R.id&&I.id)return"".concat(R.name,"/").concat(I.name)}(),")"]}),Object(c.jsxs)("div",{className:"item-text",children:["Amount (",function(){if(R.id)return R.name}(),")"]}),"my"===J&&Object(c.jsx)("div",{className:"item-placeholder"})]})]}),Object(c.jsxs)("div",{className:"sell-section",children:[Object(c.jsx)("div",{className:"section-title",children:"Sell"}),Object(c.jsx)("div",{className:"make-list reverse",children:We("sell")})]}),"all"===J&&Object(c.jsxs)("div",{className:"last-price-wrapper",children:[Object(c.jsx)("div",{className:"last-price-label",children:"Last Price"}),Object(c.jsx)("div",{className:"last-price",children:ue}),Object(c.jsx)("div",{className:"last-price-placeholder"})]}),Object(c.jsxs)("div",{className:"buy-section",children:[Object(c.jsx)("div",{className:"section-title",children:"Buy"}),Object(c.jsx)("div",{className:"make-list",children:We("buy")})]})]})]}),Object(c.jsxs)("div",{className:"token-pool",children:[Object(c.jsx)("div",{className:"container-header",children:"Token Balance"}),Object(c.jsx)("div",{className:"pool-items",children:function(){if(re.length)return re.map((function(e){return Object(c.jsxs)("div",{className:"pool-item",children:[Object(c.jsx)("div",{className:"token-name",children:e.name}),Object(c.jsx)("div",{className:"token-balance",children:e.balance})]},e.name)}))}()})]})]})},C=n(269),R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,581)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),i(e),s(e)}))};m.client.registerClient({});var T={timeout:5e3,position:v.b.TOP_RIGHT};r.a.render(Object(c.jsx)(v.a,Object(a.a)(Object(a.a)({template:C.a},T),{},{children:Object(c.jsx)(S,{})})),document.getElementById("root")),R()}},[[578,1,2]]]);
//# sourceMappingURL=main.e882fe0e.chunk.js.map